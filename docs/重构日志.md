# 项目重构日志：由视频检测转为图片检测

## 1. 数据库结构调整
- 删除原有 videos 表，新增 images 表
- detection_results 表外键由 video_id 改为 image_id
- 只保留 users、images、detection_results、logs 四张表

## 2. 后端代码重构
- 删除所有视频相关的 ORM 模型和 API
- 新增/保留图片上传、图片检测、检测结果查询等接口
- 所有 video 相关变量、路径、参数、查询、插入等全部替换为 image
- 检测相关API只保留图片检测
- 修复图片检测后端接口，检测完成后自动写入日志表（action=detect_image），保证检测操作有记录。

## 3. 前端待同步
- 后续将同步前端所有接口、字段、页面展示为 image 相关

## 4. 前端重构
- DetectionResults页面已重构为图片检测结果页面，API和字段全部image化，支持查询当前用户所有图片的检测结果。
- 后续将继续同步其他前端页面和接口为image相关。
- MainLayout和SideNav已切换为图片检测入口，删除了视频上传页面，只保留图片检测相关功能。

---

本次重构实现了系统由"以视频为核心"向"以图片为核心"的转变，极大简化了数据结构和业务流程，为后续图片检测功能的优化和维护打下了基础。

- 优化图片检测流程，前端先上传图片拿到image_id，再检测时传image_id和file，后端直接用image_id写入检测结果，保证检测结果和图片一一对应。
- 检测结果页面优化：检测详情JSON友好格式化为表格，显示类别、置信度、坐标等关键信息，提升用户可读性。
- 检测结果页面支持点击图片文件名直接预览图片，方便人工核查和比对。 